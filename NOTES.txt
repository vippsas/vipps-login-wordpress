
        $commentdata = compact(
                'comment_post_ID',
                'comment_author',
                'comment_author_email',
                'comment_author_url',
                'comment_content',
                'comment_type',
                'comment_parent',
                'user_ID'
        );


// The post handler. Also xmlrpc and probably rest api
function wp_handle_comment_submission( $comment_data ) {

// Right before comment is posted, in handle submission. Before user_is_logged_in etc
// So here, check if vipps signed, if not, store comment, sign, and on return *call the insert function again* this time signed.
// If sign fails, do the same, but return WP_Error on pre_comment_approved.
do_action( 'pre_comment_on_post', $comment_post_ID );

// This is for new comment. 
        $commentdata = apply_filters( 'preprocess_comment', $commentdata );


then this is called
  $commentdata['comment_approved'] = wp_allow_comment( $commentdata, $avoid_die );

which calls this:

  //  Return wp-error to disapprove
  return apply_filters( 'pre_comment_approved', $approved, $commentdata );
